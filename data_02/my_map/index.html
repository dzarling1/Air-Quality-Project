<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>
			My Maps
		</title>
		<!-- Leaflet -->
		<link rel="stylesheet" href="lib/leaflet/leaflet.css" />
		<script src="lib/leaflet/leaflet.js"></script>
		<script src="lib/distance-calc.js"></script>

	</head>
	<body>
		<center><h1>My Maps</h1>
			Location: <input type="text" id ="loc"><br>
			<button onclick="moveByLocation()">Submit by location</button><br>
			Lan: <input type="text"  id = "lat"><br>
 			Lon: <input  type="text" id = "lon"><br>
			<button onclick="moveByLatLon()">Submit</button>
		</center>
<div id="maps">
      <center><!--<div id = "map" style="width: 600px; height:460px; margin:10px; border:1px solid black
"></div> -->
      <div id = "map2" style="width: 600px; height:460px; margin:10px; border:1px solid black"></div></center>
</div>
		
		<!--<script src="lib/default-map.js"></script> -->



	<script>
	function moveByLocation(){
		var req = new XMLHttpRequest();
 		req.onreadystatechange = function() {
      		if (req.readyState == 4 && req.status == 200) {
        		// successfully received data!
        		var data1 =JSON.parse(req.responseText);
		        console.log(data1);
		        var lat1 = data1[0].lat;
		        var lon1 = data1[0].lon;
		        console.log(lat1);
		        document.getElementById("lat").value = lat1;
		        console.log(lon1);
		        document.getElementById("lon").value = lon1;
		        var cords = L.latLng(document.getElementById("lat").value, document.getElementById("lon").value);
				map2.panTo(cords);
      		}
    	};
    	//req.addEventListener("load", reqListener);
    	req.open("GET","https://nominatim.openstreetmap.org/search?q="+document.getElementById("loc").value+"&format=json&accept-language=en",true);

    	req.send();
		console.log("The transfer is complete location.");
	}

	function moveByLatLon(){
		var cords = L.latLng(document.getElementById("lat").value, document.getElementById("lon").value);
		map2.panTo(cords);
		var cord = map2.getCenter();
		console.log(cord);
	}
		
			var map2 = L.map('map2', {
				center : ([44.953705, -93.089958]),
				zoom: 10
			});

			var cord = map2.getCenter();
			console.log(cord);
			/*
			var countriesLayer = L.geoJson(countries).addTo(map);
			map.fitBounds(countriesLayer.getBounds());
*/
			var layer = new L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://mapbox.com">Mapbox</a>',
    maxZoom: 16,
    minZoom: 9,
    id: 'mapbox.streets',
    accessToken: 'pk.eyJ1IjoiYmJyb29rMTU0IiwiYSI6ImNpcXN3dnJrdDAwMGNmd250bjhvZXpnbWsifQ.Nf9Zkfchos577IanoKMoYQ'
  }).addTo(map2);
	
	function onMapMove() {
		var cord = map2.getCenter();
		document.getElementById("lat").value = cord.lat;
		document.getElementById("lon").value = cord.lng;
	}
	map2.on('moveend', onMapMove);
/*
	function openAQ(event){
		var radius = 4;
		var request ={
			url: "https://api.openaq.org/v1/measurements?coordinates=" + lat +"," + lon + "&radius=" + radius ,
			dataType: "json",
			success: showData
		};
		S.ajax(request);
 
		}

		function showData(data){
    		console.log(data);
		}
*/

	



/*
			function onMapClick(e) {
    alert("You clicked the map at " + e.latlng);
}
map.on('click', onMapClick);
*/			
		</script>


  <p id="result"></p>

	</body> 
</html>
